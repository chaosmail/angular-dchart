/** angular-dchart - v0.0.2 - Sun May 26 2013 20:30:23
 *  (c) 2013 Christoph KÃ¶rner, office@chaosmail.at, http://chaosmail.at
 *  License: MIT
 */
var __hasProp={}.hasOwnProperty,__extends=function(t,a){function e(){this.constructor=t}for(var n in a)__hasProp.call(a,n)&&(t[n]=a[n]);return e.prototype=a.prototype,t.prototype=new e,t.__super__=a.prototype,t},_dchart=function(){function t(){this.restrict="E",this.transclude=!0,this.scope={w:"=width",h:"=height"}}return t.prototype.getRandomColor=function(){return"hsl("+Math.random()*360+",100%,50%)"},t.prototype.getMinMaxValues=function(t){var a={x:0,y:0},e={x:0,y:0};return void 0===t||null===t?[a,e]:(angular.forEach(t,function(t){null!==t&&angular.forEach(t.data,function(t){t.x>e.x?e.x=t.x:t.x<a.x&&(a.x=t.x),t.y>e.y?e.y=t.y:t.y<a.y&&(a.y=t.y)})}),[a,e])},t.prototype.parseTransclude=function(t,a){var e=this,n=t(a);void 0!==n&&null!==n&&angular.forEach(n,function(t){t.nodeName.match(/^axis/i)?e.parseAxis(a.axis,t):t.nodeName.match(/^data-set/i)&&e.parseDataSet(a.data,t,a.axis)})},t.prototype.createSvg=function(t,a){if(t.svg===void 0||t.svg===null){var e=d3.select(a).append("svg").attr("width",t.w+t.margin.left+t.margin.right).attr("height",t.h+t.margin.top+t.margin.bottom).append("g").attr("class","dchart-container").attr("transform","translate("+t.margin.left+", "+t.margin.top+")");t.svg=e}},t.prototype.ngCompile=function(){},t.prototype.ngLink=function(){},t.prototype.ngWatch=function(){},t.prototype.compile=function(t,a,e){var n=this,r=e;return n.ngCompile(t,a,e),function(t,a,e){t.margin={top:0,right:0,bottom:0,left:0},n.ngLink(t,a,e),n.initializeAxis(t),n.initializeData(t),n.parseTransclude(r,t),n.calculateFnData(t),n.createSvg(t,a[0]),t.$watch("[data]",function(t,a,e){n.prepareChart(e),n.drawAxis(e),n.drawData(e),n.ngWatch(t,a,e)},!0)}},t}(),_dchart2D=function(t){function a(){var t=a.__super__.constructor.apply(this,arguments);return t}return __extends(a,t),a.prototype.prepareChart=function(t){if(t.data!==void 0&&t.data!==null){var a=this,e=[],n=0;angular.forEach(t.data,function(r){var i=JSON.parse(JSON.stringify(r));a.prepareDataSet(i,n),e.push(i),a.prepareAxis(t.axis,i,n),n++}),t.drawDataSets=e}},a.prototype.prepareAxis=function(t,a){void 0===a||null===a},a.prototype.prepareDataSet=function(t){if(void 0!==t&&null!==t){var a=this,e=0;angular.forEach(t.data,function(t){a.prepareData(t,e),e++})}},a.prototype.prepareData=function(t){void 0===t||null===t},a.prototype.parseDataSet=function(t,a,e){if(null!==a){var n={label:"",stroke:this.getRandomColor(),fill:"#000",opacity:1,fillOpacity:1,strokeWidth:1,fn:void 0,min:0,max:0,interpolate:"linear",data:[],dataFn:void 0},r=this;xAxis=e.x,angular.forEach(a.attributes,function(t){if(t.nodeName.match(/^label$/i))n.label=t.nodeValue;else if(t.nodeName.match(/^stroke$/i))n.stroke=t.nodeValue;else if(t.nodeName.match(/^interpolate$/i))n.interpolate=t.nodeValue;else if(t.nodeName.match(/^fill$/i))n.fill=t.nodeValue;else if(t.nodeName.match(/^min$/i))n.min=parseFloat(t.nodeValue);else if(t.nodeName.match(/^max$/i))n.max=parseFloat(t.nodeValue);else if(t.nodeName.match(/^stroke-width$/i))n.strokeWidth=parseFloat(t.nodeValue);else if(t.nodeName.match(/^fill-opacity$/i))n.fillOpacity=parseFloat(t.nodeValue);else if(t.nodeName.match(/^opacity$/i))n.opacity=parseFloat(t.nodeValue);else if(t.nodeName.match(/^data$/i)){if(t.nodeValue===void 0||t.nodeValue===null)return;var e=angular.element(a).scope(),r=t.nodeValue.split("."),i=e.$parent,o=0;if(angular.forEach(r,function(t){i.hasOwnProperty(t)&&(i=i[t],o++)}),!o)return;"function"==typeof i?n.fn=i:n.data=i}}),angular.forEach(a.children,function(t){if(t.nodeName.match(/^data/i)){var a=r.parseData(t);null!==a&&n.data.push(a)}}),t.push(n)}},a.prototype.solveFn=function(t,a){if(t.fn!==void 0&&t.fn!==null){var e=a.x,n=t.min?t.min:e.range[0]?parseFloat(e.range[0]):0,r=t.max?t.max:e.range[1]?parseFloat(e.range[1]):180,i=e.ticks?parseFloat(e.ticks):10,o=(r-n)/i;t.data=(new _solver).solve(t.fn,n,r,o)}},a.prototype.calculateFnData=function(t){if(t.data!==void 0&&t.data.length!==0){var a=this;angular.forEach(t.data,function(e){e.fn!==void 0&&a.solveFn(e,t.axis)})}},a.prototype.parseData=function(t){if(null===t)return null;var a={x:0,y:0,t:0,w:1,label:t.innerText};return angular.forEach(t.attributes,function(t){t.nodeName.match(/^x$/i)?a.x=parseFloat(t.nodeValue):t.nodeName.match(/^(y|val|value)$/i)?a.y=parseFloat(t.nodeValue):t.nodeName.match(/^(t|time)$/i)?a.t=parseFloat(t.nodeValue):t.nodeName.match(/^(w|weight)$/i)&&(a.w=parseFloat(t.nodeValue))}),a},a.prototype.parseAxis=function(t,a){if(null!==a){var e=this;angular.forEach(a.children,function(a){a.nodeName.match(/^x/i)?e.parseAxisAttributes(t.x,a):a.nodeName.match(/^y/i)&&e.parseAxisAttributes(t.y,a)})}},a.prototype.parseAxisAttributes=function(t,a){null!==a&&(t.label=a.innerText,angular.forEach(a.attributes,function(a){if(a.nodeName.match(/^ticks$/i))t.ticks=parseInt(a.nodeValue,10);else if(a.nodeName.match(/^range$/i))t.rangeOpt=a.nodeValue.replace(/[\[\]]/g,"").split(",");else if(a.nodeName.match(/^align$/i)){var e=a.nodeValue;t.type==="x"&&["top","center","bottom"].indexOf(e)>=0?t.align=e:t.type==="y"&&["left","center","right"].indexOf(e)>=0&&(t.align=e)}else if(a.nodeName.match(/^label-pos$/i)){var n=a.nodeValue;["start","middle","end"].indexOf(n)>=0&&(t.labelPos=n)}}))},a.prototype.initializeAxis=function(t){return t.axis!==void 0&&t.axis!==null?this:(t.axis={x:{type:"x",range:[0,1],rangeOpt:"auto",label:"",align:"bottom",ticks:10,ticksFormat:[],labelPos:"middle"},y:{type:"y",range:[0,1],rangeOpt:"auto",label:"",align:"left",ticks:10,ticksFormat:[],labelPos:"middle"}},this)},a.prototype.initializeData=function(t){return t.data!==void 0&&t.data!==null?this:(t.data=[],this)},a.prototype.drawAxis=function(t){var a=_dchart.prototype.getMinMaxValues(t.drawDataSets);t.axis.x.range=t.axis.x.rangeOpt==="auto"?[a[0].x,a[1].x]:t.axis.x.rangeOpt,t.axis.y.range=t.axis.y.rangeOpt==="auto"?[a[0].y,a[1].y]:t.axis.y.rangeOpt;var e=t.axis.x.align==="center"?t.h*.5:t.axis.x.align==="top"?0:t.h,n=t.axis.x.align==="top"?"top":"bottom",r=t.axis.x.labelPos==="start"?0:t.axis.x.labelPos==="middle"?t.w*.5:t.w,i=t.axis.y.align==="center"?t.w*.5:t.axis.y.align==="right"?t.w:0,o=t.axis.y.align==="right"?"right":"left",l=t.axis.y.labelPos==="start"?t.h:t.axis.y.labelPos==="middle"?t.h*.5:0;t.xScale=d3.scale.linear().domain(t.axis.x.range).range([0,t.w]),t.yScale=d3.scale.linear().domain(t.axis.y.range).range([t.h,0]);var s=d3.svg.axis().scale(t.xScale).orient(n).ticks(t.axis.x.ticks),c=d3.svg.axis().scale(t.yScale).orient(o).ticks(t.axis.y.ticks);t.axis.x.ticksFormat.length>0&&s.tickFormat(function(a){return t.axis.x.ticksFormat[a]}),t.axis.y.ticksFormat.length>0&&s.tickFormat(function(a){return t.axis.y.ticksFormat[a]}),(t.svgXAxis===void 0||t.svgXAxis===null)&&(t.svgXAxis=t.svg.append("g").attr("class","axis").call(s),t.svgXAxisLabel=t.svg.append("g").attr("class","axis-label").append("text").attr("text-anchor",t.axis.x.labelPos).attr("x",r).attr("y",t.h+34)),(t.svgYAxis===void 0||t.svgYAxis===null)&&(t.svgYAxis=t.svg.append("g").attr("class","axis").call(c),t.svgYAxisLabel=t.svg.append("g").attr("class","axis-label").append("text").attr("text-anchor",t.axis.y.labelPos).attr("x",-l).attr("y",-34).attr("transform","rotate(-90)")),t.svgXAxis.transition().duration(150).ease("cubicin").attr("transform","translate(0,"+e+")").call(s),t.svgYAxis.transition().duration(150).ease("cubicin").attr("transform","translate("+i+",0)").call(c),t.svgXAxisLabel.text(t.axis.x.label),t.svgYAxisLabel.text(t.axis.y.label)},a}(_dchart),_solver=function(){function t(){}return t.prototype.solve=function(t,a,e,n){for(var r=[],i=a;e>=i;i+=n)r.push({x:i,y:t(i)});return r},t}();angular.module("dchart.solver",[]).service("dchartSolver",function(){return new _solver});var _dchartHisto=function(t){function a(){var t=a.__super__.constructor.apply(this,arguments);return t}return __extends(a,t),a.prototype.prepareAxis=function(t,a){void 0!==a&&null!==a&&(t.x.ticks=a.data.length,t.x.ticksFormat=[],angular.forEach(a.data,function(a){t.x.ticksFormat.push(a.label)}),t.y.align==="left",t.y.align==="right")},a.prototype.prepareData=function(t,a){void 0!==t&&null!==t&&(t.hasOwnProperty("x")||(t.x=a))},a.prototype.ngLink=function(t){t.margin={top:50,right:50,bottom:50,left:50}},a.prototype.ngWatch=function(){},a.prototype.drawData=function(t){var a=t.drawDataSets.length,e=t.w/t.axis.x.ticks*1/a*.8,n=0;(t.svgData===void 0||t.svgData===null)&&(t.svgData=[]),angular.forEach(t.drawDataSets,function(r,i){(t.svgData[i]===void 0||t.svgData[i]===null)&&(t.svgData[i]=t.svg.append("g").attr("class","data"));var o=t.svgData[i].selectAll("rect").data(r.data,function(t){return t.x+" - "+t.y});o.attr("x",function(r){return t.xScale(r.x)-.5*e*a+n*e}).attr("width",function(){return e}),o.enter().append("rect").style("stroke",r.stroke).style("fill",function(t){return t.hasOwnProperty("color")?t.color:r.fill}).style("opacity",r.opacity).style("fill-opacity",r.fillOpacity).style("stroke-width",r.strokeWidth).attr("x",function(r){return t.xScale(r.x)-.5*e*a+n*e}).attr("y",t.h).attr("width",function(){return e}).attr("height",0).transition().duration(150).ease("cubicin").attr("y",function(a){return t.yScale(a.y)}).attr("height",function(a){return t.h-t.yScale(a.y)}),o.exit().transition().duration(150).ease("cubicout").attr("y",t.h).attr("height",0).each("end",function(){d3.select(this).remove()}),n++})},a}(_dchart2D);angular.module("dchart.histo",[]).directive("dchartHisto",function(){return new _dchartHisto});var _dchartLine=function(t){function a(){var t=a.__super__.constructor.apply(this,arguments);return t}return __extends(a,t),a.prototype.ngLink=function(t){t.margin={top:50,right:50,bottom:50,left:50}},a.prototype.ngWatch=function(){},a.prototype.drawData=function(t){(t.svgData===void 0||t.svgData===null)&&(t.svgData=[],t.lineFn=[]),angular.forEach(t.data,function(a,e){(t.svgData[e]===void 0||t.svgData[e]===null)&&(t.svgData[e]=t.svg.append("g").attr("class","data").append("svg:path"),t.lineFn[e]=d3.svg.line().interpolate(a.interpolate).x(function(a){return t.xScale(a.x)}).y(function(a){return t.yScale(a.y)})),t.svgData[e].transition().duration(150).ease("cubicin").attr("d",t.lineFn[e](a.data)).style("stroke",a.stroke).style("fill","none").style("stroke-width",a.strokeWidth)})},a}(_dchart2D);angular.module("dchart.line",[]).directive("dchartLine",function(){return new _dchartLine});var _dchartScatter=function(t){function a(){var t=a.__super__.constructor.apply(this,arguments);return t}return __extends(a,t),a.prototype.ngLink=function(t){t.margin={top:50,right:50,bottom:50,left:50}},a.prototype.ngWatch=function(){},a.prototype.drawData=function(t){var a=10;(t.svgData===void 0||t.svgData===null)&&(t.svgData=[],t.symbolFn=[]),angular.forEach(t.data,function(e,n){(t.svgData[n]===void 0||t.svgData[n]===null)&&(t.svgData[n]=t.svg.append("g").attr("class","data"));var r=t.svgData[n].selectAll("circle").data(e.data,function(t){return t.y});r.exit().transition().duration(150).ease("cubicout").attr("r",0).each("end",function(){d3.select(this).remove()}),r.attr("cx",function(a){return t.xScale(a.x)}).attr("cy",function(a){return t.yScale(a.y)}),r.enter().append("circle").style("stroke",e.stroke).style("fill",e.fill).style("opacity",e.opacity).style("fill-opacity",e.fillOpacity).style("stroke-width",e.strokeWidth).attr("cx",function(a){return t.xScale(a.x)}).attr("cy",function(a){return t.yScale(a.y)}).attr("r",0).transition().duration(150).ease("cubicin").attr("r",function(t){return t.w*a})})},a}(_dchart2D);angular.module("dchart.scatter",[]).directive("dchartScatter",function(){return new _dchartScatter});